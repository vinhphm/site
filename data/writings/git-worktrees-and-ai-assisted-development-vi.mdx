---
title: Git worktrees và lập trình với sự hỗ trợ của AI
added: 2025-11-25T20:07:12.235+07:00
lang: vi
description: Git worktrees đã tồn tại từ lâu, nhưng giờ đây các AI agent mới thực sự khiến nó trở nên hữu ích. Đây là lý do tại sao Claude Code thích dùng chúng và cách chúng giúp cuộc sống của bạn dễ thở hơn.
duration: 6 min read
---

Nếu bạn đang dùng Claude Code desktop gần đây, có thể bạn đã nhận ra nó làm một việc hơi lạ, thay vì làm việc trực tiếp trong repo của bạn, nó tạo ra một thứ gọi là "worktree." Thoạt nhìn, nó có vẻ phức tạp không cần thiết. Nhưng tin mình đi, có một lý do rất chính đáng cho việc này, và một khi bạn hiểu ra, bạn sẽ tự hỏi sao mình sống thiếu nó được trước đây.

## Vậy git worktree là gì?

Rồi rồi, để mình giải thích. Git worktree cho phép bạn có nhiều thư mục làm việc gắn với cùng một repository. Tạm nghĩ như thế này: bình thường khi bạn chuyển branch, bạn đang thay đổi tất cả các file trong một thư mục làm việc duy nhất. Với worktrees, bạn có thể có _nhiều_ thư mục, mỗi cái ở một branch khác nhau, tất cả đều kết nối với cùng một git repo.

Hoạt động thực thế thì là như vầy:

```bash
# Repository chính của bạn
~/projects/my-app (main branch)

# Tạo một worktree cho feature branch
git worktree add ../my-app-feature feature-branch

# Giờ bạn có hai thư mục:
~/projects/my-app (main branch)
~/projects/my-app-feature (feature-branch)
```

Cả hai thư mục đều chia sẻ cùng git history, commits, và branches. Nhưng mỗi cái có thể ở một branch khác nhau một cách độc lập. Hay ho phết ha?

## Tại sao bạn nên quan tâm? (Gợi ý nè: AI agents ✨)

Đây là lúc mọi thứ trở nên thú vị. Khi bạn làm việc với một AI coding assistant như Claude Code, về cơ bản bạn đang cộng tác với một developer khác. Và như mọi sự cộng tác, mọi thứ sẽ suôn sẻ hơn nhiều khi các bạn không giẫm chân lên nhau.

### Cách cũ khá là phiền

Tưởng tượng bạn đang review một số thay đổi mà Claude vừa làm. Rồi bạn nhận ra cần kiểm tra gì đó trên main, hoặc bạn muốn bắt đầu một task hoàn toàn khác. Với setup truyền thống, bạn sẽ phải:

1. Stash hoặc commit những thay đổi dang dở của Claude
2. Chuyển branch
3. Làm việc của bạn
4. Chuyển lại
5. Khôi phục mọi thứ

Điều này đã khá phiền với collaborators là người thật. Với một AI agent có thể đang chạm vào hàng chục file trong codebase của bạn? Ừ, đó là công thức cho việc mất context và ác mộng merge conflict.

### Worktrees ra tay cứu giúp

Với worktrees, Claude Code có được sandbox riêng biệt của nó. Bạn có thể:

- Review và test các thay đổi của Claude mà không làm rối workspace chính
- Tiếp tục làm việc khác trong thư mục chính của bạn
- Chuyển branch bất cứ khi nào bạn muốn trong khi Claude làm việc của nó
- Thử nghiệm thoải mái mà không lo mất code

Khi Claude tạo một worktree, nó giống như cho nó một bàn làm việc riêng trong văn phòng. Cả hai đều chia sẻ cùng codebase, nhưng không phải tranh nhau cùng một bàn phím.

## Claude Code xử lý việc này như thế nào

Claude Code desktop mặc định dùng worktrees cho mọi task mới. Khi bạn bắt đầu một cuộc hội thoại hoặc branch mới, nó tự động:

1. Tạo một worktree mới trong `~/.claude-worktrees/`
2. Đặt tên dựa trên tên branch
3. Checkout đúng branch
4. Làm việc hoàn toàn trong không gian riêng biệt đó

Bạn sẽ có được cấu trúc như thế này:

```
~/.claude-worktrees/
  ├── my-repo/
  │   ├── feature-authentication/
  │   ├── bugfix-login-form/
  │   └── refactor-api-client/
```

Mỗi worktree là một thư mục làm việc hoàn chỉnh cho task cụ thể đó. Khi xong, merge các thay đổi và dọn dẹp, hoặc cứ giữ lại cho sau.

## Tại sao điều này thực sự hoàn hảo cho AI workflows

Lợi ích không chỉ dừng ở việc tránh conflicts:

**Làm việc song song**: Bạn có thể chạy nhiều Claude Code sessions cùng lúc, mỗi cái trong worktree riêng, mỗi cái trên branch khác nhau. Cần review một bug fix trong khi khám phá một feature mới? Không vấn đề gì.

**Lưới an toàn**: Nếu Claude đi chệch hướng và làm những thay đổi bạn ghét, chỉ cần xóa worktree và bắt đầu lại. Repo chính của bạn vẫn nguyên vẹn.

**Context được giữ nguyên**: Mỗi worktree giữ state riêng của nó, file modifications, uncommitted changes, tất cả. Mọi thứ được cô lập và bảo toàn theo từng task.

**Diffs sạch sẽ hơn**: Khi review công việc của Claude, bạn có thể dễ dàng so sánh với main mà không có những thay đổi lẫn lộn từ việc khác bạn đang làm.

## Một vài commands cần biết

Bạn không thực sự _cần_ tự quản lý việc này, Claude Code xử lý gần hết rồi. Nhưng biết những lệnh này cũng tiện:

```bash
# Liệt kê tất cả worktrees
git worktree list

# Xóa một worktree khi xong
git worktree remove path/to/worktree

# Dọn dẹp nếu thư mục đã bị xóa
git worktree prune
```

Claude Code thường xử lý việc dọn dẹp, nhưng đôi khi bạn sẽ muốn tự tay dọn các worktrees cũ.

## Bức tranh lớn hơn

Vấn đề là vầy: git worktrees đã tồn tại từ 2015, nhưng chúng chưa bao giờ thực sự phổ biến vì lợi ích cho solo devs khá là... bình thường. Với việc AI agents xuất hiện, điều đó thay đổi hoàn toàn.

Chúng ta đang hướng tới một thế giới nơi bạn hiếm khi là người duy nhất chạm vào codebase, ngay cả khi là một solo developer. AI assistants, automated refactoring tools, code generation systems,... tất cả đều cần không gian riêng để làm việc. Worktrees cho chúng không gian đó một cách elegant, sử dụng một tính năng đã được thử nghiệm kỹ càng trong nhiều năm.

Việc Claude Code mặc định dùng worktrees không chỉ là một quyết định kỹ thuật, đó là sự thừa nhận rằng cách chúng ta viết code đang thay đổi từ từ. Càng sớm thích nghi tools và workflows với thực tế này, chúng ta sẽ càng productive hơn.

## Kết luận

Git worktrees có thể cảm thấy như quá mức cần thiết nếu bạn quen với phát triển truyền thống. Nhưng một khi bạn trải nghiệm sự tự do của việc để Claude làm việc riêng biệt trong khi bạn tiếp tục công việc của mình không bị gián đoạn rồi thì sao? Tất nhiên là khó mà quay lại được.

Đây là một trong những tính năng mà, một khi bạn hiểu _tại sao_ nó tồn tại, tự nhiên sẽ thấy nó hoàn toàn hợp lý.
